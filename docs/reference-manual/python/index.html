<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>37. truchas Python Module &mdash; Truchas Reference Manual 1.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=8d563738"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script>window.MathJax = {"chtml": {"displayAlign": "left", "displayIndent": "2em"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="PATCHES Namelist (Expert Options)" href="../rade/PATCHES_Namelist_Expert_Options.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Truchas Reference Manual
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ALTMESH_Namelist/index.html">2. ALTMESH Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../BODY_Namelist/index.html">3. BODY Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DIFFUSION_Solver_Namelist/index.html">4. DIFFUSION Solver Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DS_SOURCE_Namelist/index.html">5. DS_SOURCE Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ELECTROMAGNETICS_Namelist/index.html">6. ELECTROMAGNETICS Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ENCLOSURE_RADIATION_Namelist/index.html">7. ENCLOSURE_RADIATION Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ENCLOSURE_SURFACE_Namelist/index.html">8. ENCLOSURE_SURFACE Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../EVAPORATION_Namelist/index.html">9. EVAPORATION Namelist (Experimental)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FLOW_Namelist/index.html">10. FLOW Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FLOW_BC_Namelist/index.html">11. FLOW_BC Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FLOW_PRESSURE_SOLVER_and_FLOW_VISCOUS_SOLVER_Namelists/index.html">12. FLOW_PRESSURE_SOLVER and FLOW_VISCOUS_SOLVER Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FUNCTION_Namelist/index.html">13. FUNCTION Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../INDUCTION_COIL_Namelist/index.html">14. INDUCTION_COIL Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MATERIAL_and_PHASE_Namelists/index.html">15. MATERIAL and PHASE Namelists</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MESH_Namelist/index.html">16. MESH Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MICROSTRUCTURE_Namelist/index.html">17. MICROSTRUCTURE Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NUMERICS_Namelist/index.html">18. NUMERICS Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OUTPUTS_Namelist/index.html">19. OUTPUTS Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PHASE_CHANGE_Namelist/index.html">20. PHASE_CHANGE Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PHYSICAL_CONSTANTS_Namelist/index.html">21. PHYSICAL_CONSTANTS Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PHYSICS_Namelist/index.html">22. PHYSICS Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PROBE_Namelist/index.html">23. PROBE Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../RESTART_Namelist/index.html">24. RESTART Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SIMULATION_CONTROL_Namelist/index.html">25. SIMULATION_CONTROL Namelist (Experimental)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SOLID_MECHANICS_Namelist/index.html">26. SOLID_MECHANICS Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SOLID_MECHANICS_BC_Namelist/index.html">27. SOLID_MECHANICS_BC Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SPECIES_BC_Namelist/index.html">28. SPECIES_BC Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../THERMAL_BC_Namelist/index.html">29. THERMAL_BC Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../THERMAL_SOURCE_Namelist/index.html">30. THERMAL_SOURCE Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TOOLHEAD_Namelist/index.html">31. TOOLHEAD Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TOOLPATH_Namelist/index.html">32. TOOLPATH Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TURBULENCE_Namelist/index.html">33. TURBULENCE Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VFUNCTION_Namelist/index.html">34. VFUNCTION Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VISCOPLASTIC_MODEL_Namelist/index.html">35. VISCOPLASTIC_MODEL Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rade/index.html">36. Radiation Enclosure Tools</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">37. <code class="docutils literal notranslate"><span class="pre">truchas</span></code> Python Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#examples">37.1. Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#custom-restart">Custom Restart</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optimization">Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameter-study">Parameter Study</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#components">37.2. Components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-truchas.TruchasEnvironment">TruchasEnvironment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#truchas.TruchasEnvironment.TruchasEnvironment"><code class="docutils literal notranslate"><span class="pre">TruchasEnvironment</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-truchas.TruchasData">TruchasData</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#truchas.TruchasData.TruchasData"><code class="docutils literal notranslate"><span class="pre">TruchasData</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-truchas.TruchasMappedData">TruchasMappedData</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#truchas.TruchasMappedData.TruchasMappedData"><code class="docutils literal notranslate"><span class="pre">TruchasMappedData</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-truchas.TruchasStudy">TruchasStudy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#truchas.TruchasStudy.TruchasStudy"><code class="docutils literal notranslate"><span class="pre">TruchasStudy</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-truchas.TruchasDatabase">TruchasDatabase</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#truchas.TruchasDatabase.TruchasDatabase"><code class="docutils literal notranslate"><span class="pre">TruchasDatabase</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-truchas.TruchasTest">TruchasTest</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#truchas.TruchasTest.compare_l2"><code class="docutils literal notranslate"><span class="pre">compare_l2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#truchas.TruchasTest.compare_max"><code class="docutils literal notranslate"><span class="pre">compare_max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#truchas.TruchasTest.compare_max_rel"><code class="docutils literal notranslate"><span class="pre">compare_max_rel()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Truchas Reference Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">37. </span><code class="docutils literal notranslate"><span class="pre">truchas</span></code> Python Module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/python/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="truchas-python-module">
<h1><span class="section-number">37. </span><code class="docutils literal notranslate"><span class="pre">truchas</span></code> Python Module<a class="headerlink" href="#truchas-python-module" title="Link to this heading"></a></h1>
<p>Truchas provides a Python package for scripting. This is useful for generating
custom restarts, performing automated optimization, and performing automated
parameter studies, or computing custom metrics.</p>
<nav class="contents local" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#examples" id="id1">Examples</a></p>
<ul>
<li><p><a class="reference internal" href="#custom-restart" id="id2">Custom Restart</a></p></li>
<li><p><a class="reference internal" href="#optimization" id="id3">Optimization</a></p></li>
<li><p><a class="reference internal" href="#parameter-study" id="id4">Parameter Study</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#components" id="id5">Components</a></p>
<ul>
<li><p><a class="reference internal" href="#module-truchas.TruchasEnvironment" id="id6">TruchasEnvironment</a></p></li>
<li><p><a class="reference internal" href="#module-truchas.TruchasData" id="id7">TruchasData</a></p></li>
<li><p><a class="reference internal" href="#module-truchas.TruchasMappedData" id="id8">TruchasMappedData</a></p></li>
<li><p><a class="reference internal" href="#module-truchas.TruchasStudy" id="id9">TruchasStudy</a></p></li>
<li><p><a class="reference internal" href="#module-truchas.TruchasDatabase" id="id10">TruchasDatabase</a></p></li>
<li><p><a class="reference internal" href="#module-truchas.TruchasTest" id="id11">TruchasTest</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="examples">
<h2><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">37.1. </span>Examples</a><a class="headerlink" href="#examples" title="Link to this heading"></a></h2>
<section id="custom-restart">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">Custom Restart</a><a class="headerlink" href="#custom-restart" title="Link to this heading"></a></h3>
<p>Frequently it is necessary to generate custom mapped restarts. For example, if
we need to map data to a new mesh, where there is a new block which needs to be
initialized. Generally, we will need to initialize this block with a material
and a temperature. The below script shows how to read in a Truchas h5 file, map
it to a new mesh, and modify some field data before generating a restart file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">truchas</span>

<span class="c1"># Load truchas data from the preheat run, map it to a new mesh, and scale that mesh.</span>
<span class="n">tdata</span> <span class="o">=</span> <span class="n">truchas</span><span class="o">.</span><span class="n">TruchasMappedData</span><span class="p">(</span><span class="s2">&quot;preheat_output/preheat.h5&quot;</span><span class="p">,</span> <span class="s2">&quot;mesh2.gen&quot;</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>

<span class="c1"># Select the last cycle in the preheat output. Further calls will read data from</span>
<span class="c1"># this cycle, overwrite data at this cycle, and generate a restart with our</span>
<span class="c1"># modifications.</span>
<span class="n">sid</span> <span class="o">=</span> <span class="n">tdata</span><span class="o">.</span><span class="n">num_series</span><span class="p">()</span>

<span class="c1"># Set the VOF to [0, 1] (purely the final material in the input) in block 2</span>
<span class="n">tdata</span><span class="o">.</span><span class="n">assign_value_block</span><span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="s2">&quot;Z_TEMP&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="n">tdata</span><span class="o">.</span><span class="n">assign_value_block</span><span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="s2">&quot;Z_TEMP&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

<span class="c1"># Compute the function f = 1 + 2*x at cell centers across the mesh.</span>
<span class="n">xc</span> <span class="o">=</span> <span class="n">tdata</span><span class="o">.</span><span class="n">centroids</span><span class="p">()</span>
<span class="n">f</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">xc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Reassign the temperature to the function f, but only in blocks 1 and 3.</span>
<span class="n">tdata</span><span class="o">.</span><span class="n">assign_value_block</span><span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="s2">&quot;Z_TEMP&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">xc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Alternatively, we could read the whole field and modify it before reassigning.</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">tdata</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="s2">&quot;Z_TEMP&quot;</span><span class="p">)</span>
<span class="n">graphite_region</span> <span class="o">=</span> <span class="n">tdata</span><span class="o">.</span><span class="n">region</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">temp</span><span class="p">[</span><span class="n">graphite_region</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">graphite_region</span><span class="p">]</span>
<span class="n">tdata</span><span class="o">.</span><span class="n">assign_field</span><span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="s2">&quot;Z_TEMP&quot;</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>

<span class="c1"># Alternatively, we could use Numpy functions</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">tdata</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="s2">&quot;Z_TEMP&quot;</span><span class="p">)</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tdata</span><span class="o">.</span><span class="n">blockid</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">tdata</span><span class="o">.</span><span class="n">blockid</span><span class="p">()</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>
<span class="n">tdata</span><span class="o">.</span><span class="n">assign_field</span><span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="s2">&quot;Z_TEMP&quot;</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>

<span class="c1"># Write the custom restart file</span>
<span class="n">tdata</span><span class="o">.</span><span class="n">write_restart</span><span class="p">(</span><span class="s2">&quot;preheat.restart&quot;</span><span class="p">,</span> <span class="n">sid</span><span class="p">)</span>
</pre></div>
</div>
<p><sup>Example Truchas Python script. This script reads a Truchas output file, generates a mapped restart onto a new mesh, and overwrites data for some variables on a specific block on that new mesh.</sup></p>
</section>
<section id="optimization">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">Optimization</a><a class="headerlink" href="#optimization" title="Link to this heading"></a></h3>
<p>Python scripting can be used to execute Truchas in a loop, for example to modify
some heat flux boundary condition until the temperature at some point in the
mesh fits an expected value. We can wrap this entire process into a Python
function, then use an optimization function from the popular Scipy package to
solve <span class="math notranslate nohighlight">\(T(F) = 500\)</span> for the temperature <span class="math notranslate nohighlight">\(T\)</span> at <span class="math notranslate nohighlight">\(x = (0, 0, 0)\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>...

&amp;PROBE
  coord = 0, 0, 0
  data = &#39;temperature&#39;
  data_file = &#39;top-temperature.txt&#39;
/

...

&amp;THERMAL_BC
  name = &#39;heat-coil&#39;
  face_set_ids = 14
  type = &#39;flux&#39;
  flux = -{heat_flux:.4e} ! [W / m^2]
/

...
</pre></div>
</div>
<p><sup>Part of a Truchas template input, here named template-heatup.inp. The text {heat_flux:.4e} will be replaced by the Python-generated input deck below.</sup></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">spopt</span>

<span class="kn">import</span> <span class="nn">truchas</span>

<span class="k">def</span> <span class="nf">final_top_temperature</span><span class="p">(</span><span class="n">heat_flux</span><span class="p">,</span> <span class="n">tenv</span><span class="p">,</span> <span class="n">nprocs</span><span class="p">):</span>
    <span class="c1"># Generate input deck</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;heat_flux&quot;</span><span class="p">:</span> <span class="n">heat_flux</span><span class="p">}</span>
    <span class="n">tenv</span><span class="o">.</span><span class="n">generate_input_deck</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="s2">&quot;template-heatup.inp&quot;</span><span class="p">,</span> <span class="s2">&quot;heatup.inp&quot;</span><span class="p">)</span>

    <span class="c1"># Run truchas with the new input</span>
    <span class="n">stdout</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">tenv</span><span class="o">.</span><span class="n">truchas</span><span class="p">(</span><span class="n">nprocs</span><span class="p">,</span> <span class="s2">&quot;block-heatup.inp&quot;</span><span class="p">)</span>

    <span class="c1"># Read the temperature probe</span>
    <span class="n">temperature</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">probe_data</span><span class="p">(</span><span class="s2">&quot;top-temperature.txt&quot;</span><span class="p">)</span>

    <span class="c1"># It is useful to print both the input and output for every iteration,</span>
    <span class="c1"># since each iteration is a full simulation and can be slow.</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;heat_flux = </span><span class="si">{</span><span class="n">heat_flux</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="s2">, temperature = </span><span class="si">{</span><span class="n">temperature</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4e</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Return the last element (final time) of the second column (temperature column)</span>
    <span class="k">return</span> <span class="n">temperature</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">nprocs</span> <span class="o">=</span> <span class="mi">8</span>

    <span class="c1"># We need to allow overwriting the output directory, since each iteration of</span>
    <span class="c1"># the optimizer will re-run Truchas.</span>
    <span class="n">tenv</span> <span class="o">=</span> <span class="n">truchas</span><span class="o">.</span><span class="n">TruchasEnvironment</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">overwrite_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># We&#39;ll wrap our function final_top_temperature in a lambda, so we can pass</span>
    <span class="c1"># in the TruchasEnvironment and nprocs variables. We&#39;ll also offset by our</span>
    <span class="c1"># target value, since we&#39;re using a root finder.</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">final_top_temperature</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tenv</span><span class="p">,</span> <span class="n">nprocs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">500</span>

    <span class="c1"># The Scipy.Optimize.brentq root finder is used. Here we&#39;re passing our</span>
    <span class="c1"># lambda, an interval for our heat flux of [2.5e4, 5e4], a tolerance of 50</span>
    <span class="c1"># K, and absolute and relative tolerances on the heat flux.</span>
    <span class="n">heat_flux</span> <span class="o">=</span> <span class="n">spopt</span><span class="o">.</span><span class="n">brentq</span><span class="p">(</span><span class="n">fx</span><span class="p">,</span> <span class="mf">2.5e4</span><span class="p">,</span> <span class="mf">5e4</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">5e-3</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">heat_flux</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="parameter-study">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Parameter Study</a><a class="headerlink" href="#parameter-study" title="Link to this heading"></a></h3>
<p>Suppose we wish to perform the following parameter study: Vary the heat flux on
one boundary condition, and measure the maximum and average temperature in block
1. The following script will define the custom output metrics (max and avg
temperature on block 1), the parameter dictionary, and perform the parameter
study. This will produce a text file <cite>vary_heat_flux.txt</cite> which contains a table
with the input and output values.</p>
<p>This script will also generate a database which caches Truchas outputs. This way,
if we re-run the parameter study with more heat flux values later, we don’t need
to re-run entire simulations which have already been computed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">truchas</span>


<span class="c1"># read the maximum temperature in block 1</span>
<span class="k">def</span> <span class="nf">max_temperature_str</span><span class="p">(</span><span class="n">input_parameters</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
    <span class="n">sid</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">num_series</span><span class="p">()</span>
    <span class="n">temperature</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="s2">&quot;Z_TEMP&quot;</span><span class="p">)</span>
    <span class="n">block1</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">region</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">max_temperature</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">temperature</span><span class="p">[</span><span class="n">block1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max temperature = </span><span class="si">{</span><span class="n">max_temperature</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> K.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">max_temperature</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>


<span class="c1"># compute the average temperature in block 1</span>
<span class="k">def</span> <span class="nf">avg_temperature_str</span><span class="p">(</span><span class="n">input_parameters</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
    <span class="n">sid</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">num_series</span><span class="p">()</span>
    <span class="n">temperature</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="s2">&quot;Z_TEMP&quot;</span><span class="p">)</span>
    <span class="n">cell_volume</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">volumes</span><span class="p">()</span>
    <span class="n">block1</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">region</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">avg_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">temperature</span><span class="p">[</span><span class="n">block1</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="n">cell_volume</span><span class="p">[</span><span class="n">block1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Avg temperature = </span><span class="si">{</span><span class="n">avg_temp</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> K.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">avg_tmp</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Store the results from each run in a database. If we wish to run this</span>
    <span class="c1"># parameter study again with additional points, each run will be cached so</span>
    <span class="c1"># we don&#39;t need to re-run data we&#39;ve already calculated.</span>
    <span class="n">nproc</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">tenv</span> <span class="o">=</span> <span class="n">truchas</span><span class="o">.</span><span class="n">TruchasEnvironment</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">overwrite_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tdb</span> <span class="o">=</span> <span class="n">truchas</span><span class="o">.</span><span class="n">TruchasDatabase</span><span class="p">(</span><span class="s2">&quot;parameter_study&quot;</span><span class="p">)</span>
    <span class="n">tstudy</span> <span class="o">=</span> <span class="n">truchas</span><span class="o">.</span><span class="n">TruchasStudy</span><span class="p">(</span><span class="n">tenv</span><span class="p">,</span> <span class="n">tdb</span><span class="p">,</span> <span class="n">nproc</span><span class="p">)</span>

    <span class="c1"># Suppose the template file has multiple values that need to be inserted,</span>
    <span class="c1"># but we&#39;re only doing a parameter study on &quot;heat_flux2&quot;.</span>
    <span class="n">input_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;heat_flux1&quot;</span><span class="p">:</span> <span class="mf">4e4</span><span class="p">,</span>
                        <span class="s2">&quot;heat_flux2&quot;</span><span class="p">:</span> <span class="mf">1e4</span><span class="p">,</span>
                        <span class="p">}</span>
    <span class="n">heat_flux2_points</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e4</span><span class="p">,</span> <span class="mf">2e4</span><span class="p">,</span> <span class="mf">4e4</span><span class="p">]</span>

    <span class="c1"># The output will be a text file with the following columns: &quot;heat_flux2&quot;,</span>
    <span class="c1"># &quot;max_temperature&quot;, and &quot;average_temperature&quot;. The latter two are custom</span>
    <span class="c1"># output metrics, tied to functions defined above.</span>
    <span class="n">output_metrics</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;max_temperature&quot;</span><span class="p">:</span> <span class="n">max_temperature_str</span><span class="p">,</span>
                      <span class="s2">&quot;average_temperature&quot;</span><span class="p">:</span> <span class="n">avg_temperature_str</span><span class="p">,</span>
                      <span class="p">}</span>

    <span class="n">tstudy</span><span class="o">.</span><span class="n">do_1d_parameter_study</span><span class="p">(</span><span class="s2">&quot;template-heatup.inp&quot;</span><span class="p">,</span>
                                 <span class="n">input_parameters</span><span class="p">,</span> <span class="s2">&quot;heat_flux2&quot;</span><span class="p">,</span> <span class="n">heat_flux2_points</span><span class="p">,</span>
                                 <span class="n">output_metrics</span><span class="p">,</span> <span class="s2">&quot;vary_heat_flux.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="components">
<h2><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">37.2. </span>Components</a><a class="headerlink" href="#components" title="Link to this heading"></a></h2>
<section id="module-truchas.TruchasEnvironment">
<span id="truchasenvironment"></span><h3><a class="toc-backref" href="#id6" role="doc-backlink">TruchasEnvironment</a><a class="headerlink" href="#module-truchas.TruchasEnvironment" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="truchas.TruchasEnvironment.TruchasEnvironment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TruchasEnvironment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mpiexec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truchas_executable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_restart_executable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasEnvironment.TruchasEnvironment" title="Link to this definition"></a></dt>
<dd><p>This is the main interface for running Truchas via Python, grabbing outputs,
and writing restarts. It is usually recommended to initialize your
environment using the default initializer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tenv</span> <span class="o">=</span> <span class="n">truchas</span><span class="o">.</span><span class="n">TruchasEnvironment</span><span class="o">.</span><span class="n">default</span><span class="p">()</span>
</pre></div>
</div>
<p>See the <code class="docutils literal notranslate"><span class="pre">default</span></code> method for more parameters.</p>
<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasEnvironment.TruchasEnvironment.default">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasEnvironment.TruchasEnvironment.default" title="Link to this definition"></a></dt>
<dd><p>Initialize using the CMake-generated default configuration. The working
directory is initialized to the <code class="docutils literal notranslate"><span class="pre">input_dir</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – The directory which contains the input file and where
the output directory should be created. May be an absolute path, or
relative to the current working directory. Defaults to the current
working directory.</p></li>
<li><p><strong>overwrite_output</strong> (<em>bool</em><em>, </em><em>optional</em>) – Choose whether or not to overwrite the
output by default on subsequent calls to .truchas(…). Defaults to
True if the <code class="docutils literal notranslate"><span class="pre">TRUCHAS_OVERWRITE_OUTPUT</span></code> environment variable is
defined to a nonzero value, and False otherwise.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasEnvironment.TruchasEnvironment.from_argv">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_argv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasEnvironment.TruchasEnvironment.from_argv" title="Link to this definition"></a></dt>
<dd><p>Initialize from command line arguments.</p>
<p>usage: <code class="docutils literal notranslate"><span class="pre">test.py</span> <span class="pre">[-h]</span> <span class="pre">-c</span> <span class="pre">CONFIG</span> <span class="pre">[-o</span> <span class="pre">OUTPUT]</span></code></p>
<dl class="option-list">
<dt><kbd><span class="option">-h</span>, <span class="option">--help</span></kbd></dt>
<dd><p>show this help message and exit</p>
</dd>
<dt><kbd><span class="option">-c <var>CONFIG</var></span>, <span class="option">--config <var>CONFIG</var></span></kbd></dt>
<dd><p>CMake-generated configuration file</p>
</dd>
<dt><kbd><span class="option">-o <var>OUTPUT</var></span>, <span class="option">--output <var>OUTPUT</var></span></kbd></dt>
<dd><p>Output directory</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasEnvironment.TruchasEnvironment.from_config_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">working_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasEnvironment.TruchasEnvironment.from_config_file" title="Link to this definition"></a></dt>
<dd><p>Initialize from a json configuration file, input directory, and an
optional working directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config_file</strong> (<em>str</em>) – Filename of the input JSON file containing the
configuration parameters described below. May be relative to the
current working directory, or an absolute path.</p></li>
<li><p><strong>input_dir</strong> (<em>str</em>) – The directory which contains the input file. May be an
absolute path, or relative to the current working directory.</p></li>
<li><p><strong>working_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – The directory where output directories should be
generated. May be an absolute path, or relative to the current
working directory. Defaults to the current working directory.</p></li>
</ul>
</dd>
</dl>
<p>JSON configuration file parameters:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>&quot;mpiexec&quot;</strong> (<em>str</em>) – Path to the <code class="docutils literal notranslate"><span class="pre">mpiexec</span></code> executable.</p></li>
<li><p><strong>&quot;truchas_executable&quot;</strong> (<em>str</em>) – Path to the <code class="docutils literal notranslate"><span class="pre">truchas</span></code> executable.</p></li>
<li><p><strong>&quot;write_restart_executable&quot;</strong> (<em>str</em>) – Path to the <code class="docutils literal notranslate"><span class="pre">write-restart.py</span></code>
executable.</p></li>
<li><p><strong>&quot;overwrite_output&quot;</strong> (<em>bool</em>) – Chooses whether to overwrite the output by
default or not.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasEnvironment.TruchasEnvironment.generate_input_deck">
<span class="sig-name descname"><span class="pre">generate_input_deck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">replacements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_filenames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasEnvironment.TruchasEnvironment.generate_input_deck" title="Link to this definition"></a></dt>
<dd><p>Generates a truchas input file from a template (or templates) and
replacements. Expects a dictionary of replacements, e.g. <code class="docutils literal notranslate"><span class="pre">{&quot;sigma&quot;:</span>
<span class="pre">1.2e-3}</span></code>. Will replace Python format-strings in the input template
file, e.g. <code class="docutils literal notranslate"><span class="pre">{sigma}</span></code> is then replaced with <code class="docutils literal notranslate"><span class="pre">.0012</span></code>. Formatting can
be specified in the input template in the typical Python way, such as
<code class="docutils literal notranslate"><span class="pre">{sigma:.2e}</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>replacements</strong> (<em>dict</em>) – A dictionary of replacements to be inserted into
the Truchas input deck according to the given template. Dictionary
keys are the strings to replace, e.g. <code class="docutils literal notranslate"><span class="pre">&quot;sigma&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;temp&quot;</span></code>,
and the values are the items to insert.</p></li>
<li><p><strong>template_filename</strong> (<em>str</em><em> or </em><em>list</em><em> of </em><em>str</em>) – Filename of the template for the Truchas input
deck. Can also be a list of template filenames that should be
concatenated. Should contain Python format-strings, such as
<code class="docutils literal notranslate"><span class="pre">{sigma}</span></code> or <code class="docutils literal notranslate"><span class="pre">{sigma:.2e}</span></code> where replacements from the
dictionary (e.g. <code class="docutils literal notranslate"><span class="pre">{&quot;sigma&quot;:</span> <span class="pre">1.2e-3}</span></code>) will be inserted.</p></li>
<li><p><strong>output_filename</strong> (<em>str</em>) – Filename of the generated Truchas input deck.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasEnvironment.TruchasEnvironment.input_directory">
<span class="sig-name descname"><span class="pre">input_directory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasEnvironment.TruchasEnvironment.input_directory" title="Link to this definition"></a></dt>
<dd><p>Return the input directory</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasEnvironment.TruchasEnvironment.open_data">
<span class="sig-name descname"><span class="pre">open_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasEnvironment.TruchasEnvironment.open_data" title="Link to this definition"></a></dt>
<dd><p>Returns an output data object from an h5file, expected to be
relative to the working directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>h5file</strong> (<em>str</em>) – A Truchas output .h5 file. Expected to be relative to
the working directory.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#truchas.TruchasData.TruchasData" title="truchas.TruchasData.TruchasData">TruchasData</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasEnvironment.TruchasEnvironment.output">
<span class="sig-name descname"><span class="pre">output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasEnvironment.TruchasEnvironment.output" title="Link to this definition"></a></dt>
<dd><p>Returns an output data object from an h5file, expected to be
relative to the input directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>h5file</strong> (<em>str</em>) – A Truchas output .h5 file. Expected to be relative to
the input directory.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#truchas.TruchasData.TruchasData" title="truchas.TruchasData.TruchasData">TruchasData</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasEnvironment.TruchasEnvironment.truchas">
<span class="sig-name descname"><span class="pre">truchas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nprocs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restart_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasEnvironment.TruchasEnvironment.truchas" title="Link to this definition"></a></dt>
<dd><p>Runs truchas with specified number of MPI ranks, and returns the
terminal output and the output data.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">stdout,</span> <span class="pre">output</span> <span class="pre">=</span> <span class="pre">tenv.truchas(4,</span> <span class="pre">&quot;cast.inp&quot;)</span></code></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nprocs</strong> (<em>int</em>) – Number of MPI ranks.</p></li>
<li><p><strong>input_file</strong> (<em>str</em>) – Filename of a Truchas input deck.</p></li>
<li><p><strong>restart_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename of a Truchas restart file.</p></li>
<li><p><strong>output_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – User-specified Truchas output directory.</p></li>
<li><p><strong>overwrite_output</strong> (<em>bool</em><em>, </em><em>optional</em>) – Overwrite the output directory if it already
exists. Defaults to the value provided to the TruchasEnvironment
initializer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>stdout and Truchas output data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, <a class="reference internal" href="#truchas.TruchasData.TruchasData" title="truchas.TruchasData.TruchasData">TruchasData</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasEnvironment.TruchasEnvironment.working_directory">
<span class="sig-name descname"><span class="pre">working_directory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasEnvironment.TruchasEnvironment.working_directory" title="Link to this definition"></a></dt>
<dd><p>Return the working directory</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasEnvironment.TruchasEnvironment.write_restart">
<span class="sig-name descname"><span class="pre">write_restart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cycle_number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restart_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasEnvironment.TruchasEnvironment.write_restart" title="Link to this definition"></a></dt>
<dd><p>Write a restart file from the given H5 dump and cycle number to
the given file. Files expected to be relative to working directory.</p>
<p>WARNING: This calls the <code class="docutils literal notranslate"><span class="pre">write-restart.py</span></code> program, and is primarily
used for testing. Usually in Python scripts, it is better to use the
<code class="xref py py-func docutils literal notranslate"><span class="pre">TruchasData.write_restart()</span></code> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h5file</strong> (<em>str</em>) – A Truchas output .h5 file. Expected to be relative to
the working directory.</p></li>
<li><p><strong>cycle_number</strong> (<em>int</em>) – The cycle used to generate the restart file.</p></li>
<li><p><strong>restart_file</strong> (<em>str</em>) – The name of the restart file to be generated.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-truchas.TruchasData">
<span id="truchasdata"></span><h3><a class="toc-backref" href="#id7" role="doc-backlink">TruchasData</a><a class="headerlink" href="#module-truchas.TruchasData" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TruchasData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData" title="Link to this definition"></a></dt>
<dd><p>A class for reading and interacting with Truchas output data. It provides
access to fields, and allows users to manipulate them.</p>
<p>Field manipulation is in-memory, not saved to the H5 file. The Truchas
output is read-only. Modifying data is intended for modified restarts, and
is done through the assign_field and assign_value functions. The field
routine will return a user-modified field, if one has been assigned via one
of those two methods.</p>
<p>TruchasData objects may be directly initialized by its initializer.
TruchasData objects are also provided by <code class="xref py py-func docutils literal notranslate"><span class="pre">TruchasEnvironment.truchas()</span></code>
and <code class="xref py py-func docutils literal notranslate"><span class="pre">TruchasEnvironment.output()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Filename of the Truchas h5 output file.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.assign_field">
<span class="sig-name descname"><span class="pre">assign_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.assign_field" title="Link to this definition"></a></dt>
<dd><p>Reassign a field with a user-defined copy. Future calls to
<a class="reference internal" href="#truchas.TruchasData.TruchasData.field" title="truchas.TruchasData.TruchasData.field"><code class="xref py py-func docutils literal notranslate"><span class="pre">TruchasData.field()</span></code></a> will return this copy, and this copy will
be used in any restarts.</p>
<p>Note: VOF is a 2D array. The order of the elements is the same as listed
in the <code class="docutils literal notranslate"><span class="pre">PHYSICS</span></code> namelist <code class="docutils literal notranslate"><span class="pre">materials</span></code> parameter and <code class="docutils literal notranslate"><span class="pre">MATERIAL</span></code>
namelists <code class="docutils literal notranslate"><span class="pre">phases</span></code> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series_id</strong> (<em>int</em>) – The ID of a series in the Truchas output file. Valid
values are in the range <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">TruchasData.num_series()]</span></code>.</p></li>
<li><p><strong>field_name</strong> (<em>str</em>) – The name of a field in the Truchas output file. Valid
values include <code class="docutils literal notranslate"><span class="pre">&quot;Z_TEMP&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Z_RHO&quot;</span></code> (density),
<code class="docutils literal notranslate"><span class="pre">&quot;Z_ENTHALPY&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;phi1&quot;</span></code> (species 1 concentration), <code class="docutils literal notranslate"><span class="pre">&quot;sigma&quot;</span></code>
(stress tensor), <code class="docutils literal notranslate"><span class="pre">&quot;epsilon&quot;</span></code> (strain tensor), <code class="docutils literal notranslate"><span class="pre">&quot;epstherm&quot;</span></code>
(thermal strain), <code class="docutils literal notranslate"><span class="pre">&quot;Rotation&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Displacement&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Gap</span>
<span class="pre">Displacement&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Gap</span> <span class="pre">Normal</span> <span class="pre">Traction&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;VOF&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Z_P&quot;</span></code>
(pressure), and <code class="docutils literal notranslate"><span class="pre">&quot;Z_VC&quot;</span></code> (velocity). Valid values for the active
h5 file can be found with the <a class="reference internal" href="#truchas.TruchasData.TruchasData.field_names" title="truchas.TruchasData.TruchasData.field_names"><code class="xref py py-func docutils literal notranslate"><span class="pre">TruchasData.field_names()</span></code></a>
function.</p></li>
<li><p><strong>field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or number) – When assigning to a scalar field (.e.g <code class="docutils literal notranslate"><span class="pre">&quot;Z_TEMP&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;Z_RHO&quot;</span></code>), expected is either a 1D Numpy array with the same
length as the field being overwritten (<code class="docutils literal notranslate"><span class="pre">ncell</span></code> or <code class="docutils literal notranslate"><span class="pre">nnode</span></code>), or a
number. When assigning to a 2D array (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;VOF&quot;</span></code> or
<code class="docutils literal notranslate"><span class="pre">&quot;sigma&quot;</span></code>), expected is either a 2D Numpy array with the same
shape as the field being written, or a 1D Numpy array with the same
length as the second dimension of the field being overwritten
(<code class="docutils literal notranslate"><span class="pre">field.shape[1]</span></code>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.assign_value_block">
<span class="sig-name descname"><span class="pre">assign_value_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blockid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.assign_value_block" title="Link to this definition"></a></dt>
<dd><p>Assign a value to a field within an element block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series_id</strong> (<em>int</em>) – The ID of a series in the Truchas output file. Valid
values are in the range <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">TruchasData.num_series()]</span></code>.</p></li>
<li><p><strong>blockid</strong> (<em>int</em>) – The ID of cell block in the Truchas output file.</p></li>
<li><p><strong>field_name</strong> (<em>str</em>) – The name of a field in the Truchas output file. Valid
values include <code class="docutils literal notranslate"><span class="pre">&quot;Z_TEMP&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Z_RHO&quot;</span></code> (density),
<code class="docutils literal notranslate"><span class="pre">&quot;Z_ENTHALPY&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;phi1&quot;</span></code> (species 1 concentration), <code class="docutils literal notranslate"><span class="pre">&quot;sigma&quot;</span></code>
(stress tensor), <code class="docutils literal notranslate"><span class="pre">&quot;epsilon&quot;</span></code> (strain tensor), <code class="docutils literal notranslate"><span class="pre">&quot;epstherm&quot;</span></code>
(thermal strain), <code class="docutils literal notranslate"><span class="pre">&quot;Rotation&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Displacement&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Gap</span>
<span class="pre">Displacement&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Gap</span> <span class="pre">Normal</span> <span class="pre">Traction&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;VOF&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Z_P&quot;</span></code>
(pressure), and <code class="docutils literal notranslate"><span class="pre">&quot;Z_VC&quot;</span></code> (velocity). Valid values for the active
h5 file can be found with the <a class="reference internal" href="#truchas.TruchasData.TruchasData.field_names" title="truchas.TruchasData.TruchasData.field_names"><code class="xref py py-func docutils literal notranslate"><span class="pre">TruchasData.field_names()</span></code></a>
function.</p></li>
<li><p><strong>field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or number) – When assigning to a scalar field (.e.g <code class="docutils literal notranslate"><span class="pre">&quot;Z_TEMP&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;Z_RHO&quot;</span></code>), expected is either a 1D Numpy array with the same
length as the field being overwritten (<code class="docutils literal notranslate"><span class="pre">ncell</span></code> or <code class="docutils literal notranslate"><span class="pre">nnode</span></code>), or a
number. When assigning to a 2D array (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;VOF&quot;</span></code> or
<code class="docutils literal notranslate"><span class="pre">&quot;sigma&quot;</span></code>), expected is either a 2D Numpy array with the same
shape as the field being written, or a 1D Numpy array with the same
length as the second dimension of the field being overwritten
(<code class="docutils literal notranslate"><span class="pre">field.shape[1]</span></code>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.assign_value_cell">
<span class="sig-name descname"><span class="pre">assign_value_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.assign_value_cell" title="Link to this definition"></a></dt>
<dd><p>Assign a value to a field at a given cell. This is equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">TruchasData</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="s2">&quot;xxx&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="p">[</span><span class="n">cellid</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
<span class="n">TruchasData</span><span class="o">.</span><span class="n">assign_field</span><span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="s2">&quot;xxx&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series_id</strong> (<em>int</em>) – The ID of a series in the Truchas output file. Valid
values are in the range <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">TruchasData.num_series()]</span></code>.</p></li>
<li><p><strong>blockid</strong> (<em>int</em>) – The ID of cell block in the Truchas output file.</p></li>
<li><p><strong>field_name</strong> (<em>str</em>) – The name of a field in the Truchas output file. Valid
values include <code class="docutils literal notranslate"><span class="pre">&quot;Z_TEMP&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Z_RHO&quot;</span></code> (density),
<code class="docutils literal notranslate"><span class="pre">&quot;Z_ENTHALPY&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;phi1&quot;</span></code> (species 1 concentration), <code class="docutils literal notranslate"><span class="pre">&quot;sigma&quot;</span></code>
(stress tensor), <code class="docutils literal notranslate"><span class="pre">&quot;epsilon&quot;</span></code> (strain tensor), <code class="docutils literal notranslate"><span class="pre">&quot;epstherm&quot;</span></code>
(thermal strain), <code class="docutils literal notranslate"><span class="pre">&quot;Rotation&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Displacement&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Gap</span>
<span class="pre">Displacement&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Gap</span> <span class="pre">Normal</span> <span class="pre">Traction&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;VOF&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Z_P&quot;</span></code>
(pressure), and <code class="docutils literal notranslate"><span class="pre">&quot;Z_VC&quot;</span></code> (velocity). Valid values for the active
h5 file can be found with the <a class="reference internal" href="#truchas.TruchasData.TruchasData.field_names" title="truchas.TruchasData.TruchasData.field_names"><code class="xref py py-func docutils literal notranslate"><span class="pre">TruchasData.field_names()</span></code></a>
function.</p></li>
<li><p><strong>field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> or number) – When assigning to a scalar field (.e.g <code class="docutils literal notranslate"><span class="pre">&quot;Z_TEMP&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;Z_RHO&quot;</span></code>), expected is a scalar number. When assigning to a 2D
array (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;VOF&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;sigma&quot;</span></code>), expected is a 1D Numpy array
with the same length as the second dimension of the field being
overwritten (<code class="docutils literal notranslate"><span class="pre">field.shape[1]</span></code>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.blockid">
<span class="sig-name descname"><span class="pre">blockid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.blockid" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A ncell length field of integers, holding the Exodus block ID
at for each cell.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.centroids">
<span class="sig-name descname"><span class="pre">centroids</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.centroids" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A <code class="docutils literal notranslate"><span class="pre">[ncell,3]</span></code> field of cell centroids.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.cycle">
<span class="sig-name descname"><span class="pre">cycle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.cycle" title="Link to this definition"></a></dt>
<dd><p>Return the cycle number of a given series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>series_id</strong> (<em>int</em>) – The ID of a series in the Truchas output file. Valid
values are in the range <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">TruchasData.num_series()]</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The cycle number at the given series_id</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.field">
<span class="sig-name descname"><span class="pre">field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.field" title="Link to this definition"></a></dt>
<dd><p>Return the requested field of the requested series as a ndarray.
This will read the entire field from disk. If the field has been
reassigned, returns the user-defined copy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series_id</strong> (<em>int</em>) – The ID of a series in the Truchas output file. Valid
values are in the range <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">TruchasData.num_series()]</span></code>.</p></li>
<li><p><strong>field_name</strong> (<em>str</em>) – The name of a field in the Truchas output file. Valid
values include <code class="docutils literal notranslate"><span class="pre">&quot;Z_TEMP&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Z_RHO&quot;</span></code> (density),
<code class="docutils literal notranslate"><span class="pre">&quot;Z_ENTHALPY&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;phi1&quot;</span></code> (species 1 concentration), <code class="docutils literal notranslate"><span class="pre">&quot;sigma&quot;</span></code>
(stress tensor), <code class="docutils literal notranslate"><span class="pre">&quot;epsilon&quot;</span></code> (strain tensor), <code class="docutils literal notranslate"><span class="pre">&quot;epstherm&quot;</span></code>
(thermal strain), <code class="docutils literal notranslate"><span class="pre">&quot;Rotation&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Displacement&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Gap</span>
<span class="pre">Displacement&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Gap</span> <span class="pre">Normal</span> <span class="pre">Traction&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;VOF&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Z_P&quot;</span></code>
(pressure), and <code class="docutils literal notranslate"><span class="pre">&quot;Z_VC&quot;</span></code> (velocity). Valid values for the active
h5 file can be found with the <a class="reference internal" href="#truchas.TruchasData.TruchasData.field_names" title="truchas.TruchasData.TruchasData.field_names"><code class="xref py py-func docutils literal notranslate"><span class="pre">TruchasData.field_names()</span></code></a>
function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The requested field from the H5 file. If the field has been
reassigned, returns the user-defined copy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.field_names">
<span class="sig-name descname"><span class="pre">field_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.field_names" title="Link to this definition"></a></dt>
<dd><p>Return a list of field names present in the first series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>series_id</strong> (<em>int</em><em>, </em><em>optional</em>) – The ID of a series in the Truchas output file. Valid
values are in the range <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">TruchasData.num_series()]</span></code>. Defaults
to 1. Usually the fields present does not change over the course
of a simulation.</p>
</dd>
<dt class="field-even">Result<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of field names present in the requested series.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of strings</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.filename">
<span class="sig-name descname"><span class="pre">filename</span></span><a class="headerlink" href="#truchas.TruchasData.TruchasData.filename" title="Link to this definition"></a></dt>
<dd><p>The filename of the HDF5 Truchas output.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.node_coordinates">
<span class="sig-name descname"><span class="pre">node_coordinates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.node_coordinates" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A <code class="docutils literal notranslate"><span class="pre">[nnode,3]</span></code> field of node coordinates.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.num_series">
<span class="sig-name descname"><span class="pre">num_series</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.num_series" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of series in this file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.num_species">
<span class="sig-name descname"><span class="pre">num_species</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.num_species" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of species in this file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.probe_data">
<span class="sig-name descname"><span class="pre">probe_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">probe_filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.probe_data" title="Link to this definition"></a></dt>
<dd><p>Read data from a probe file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>probe_filename</strong> (<em>str</em>) – Name of a probe file. Expected to be
relative to the directory holding the h5 file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D array containing the text file data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.region">
<span class="sig-name descname"><span class="pre">region</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">region_blockids</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.region" title="Link to this definition"></a></dt>
<dd><p>Return a list of bools indicating which cells are part of a given
set of block ids. Input is an arbitrary number of block id integers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>region_blockids</strong> (<em>int</em>) – <p>An arbitrary number of block id integers. This
function takes an arbitrary number of arguments, not a list. E.g.,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TruchasData</span><span class="o">.</span><span class="n">region</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">TruchasData</span><span class="o">.</span><span class="n">region</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A list of bools indicating which cells are part of a given
set of block ids. E.g., <code class="docutils literal notranslate"><span class="pre">[True,</span> <span class="pre">False,</span> <span class="pre">False,</span> <span class="pre">True,</span> <span class="pre">...]</span></code>. This is
useful for masking off operations, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">TruchasData</span><span class="o">.</span><span class="n">region</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">f1</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">f2</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">f1</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> of bools</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.region_node">
<span class="sig-name descname"><span class="pre">region_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">region_blockids</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.region_node" title="Link to this definition"></a></dt>
<dd><p>Return a list of bools indicating which nodes are part of a given
set of block ids. Input is an arbitrary number of block id integers.
A node is considered part of the given block set if any one of the cells
adjacent to it is part of one block in that set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>region_blockids</strong> (<em>int</em>) – <p>An arbitrary number of block id integers. This
function takes an arbitrary number of arguments, not a list. E.g.,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TruchasData</span><span class="o">.</span><span class="n">region</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">TruchasData</span><span class="o">.</span><span class="n">region</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A list of bools indicating which nodes are part of a given
set of block ids. E.g., <code class="docutils literal notranslate"><span class="pre">[True,</span> <span class="pre">False,</span> <span class="pre">False,</span> <span class="pre">True,</span> <span class="pre">...]</span></code>. This is
useful for masking off operations, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">TruchasData</span><span class="o">.</span><span class="n">region</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">f1</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">f2</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">f1</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> of bools</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.series_id">
<span class="sig-name descname"><span class="pre">series_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cycle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.series_id" title="Link to this definition"></a></dt>
<dd><p>Return the series id of a given cycle. If not found, returns None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cycle</strong> (<em>int</em>) – The number of a Truchas cycle.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The series ID matching a given cycle. If there is no series
exactly matching the cycle, returns None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.stdout">
<span class="sig-name descname"><span class="pre">stdout</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.stdout" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Truchas stdout</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.time">
<span class="sig-name descname"><span class="pre">time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.time" title="Link to this definition"></a></dt>
<dd><p>Return the time at a given series number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>series_id</strong> (<em>int</em>) – The ID of a series in the Truchas output file. Valid
values are in the range <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">TruchasData.num_series()]</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The time at the given series_id</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.time_step">
<span class="sig-name descname"><span class="pre">time_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.time_step" title="Link to this definition"></a></dt>
<dd><p>Return the time step size at a given series number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>series_id</strong> (<em>int</em>) – The ID of a series in the Truchas output file. Valid
values are in the range <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">TruchasData.num_series()]</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The time step size at the given series_id</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.volumes">
<span class="sig-name descname"><span class="pre">volumes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.volumes" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A length <code class="docutils literal notranslate"><span class="pre">ncell</span></code> field of cell volumes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasData.TruchasData.write_restart">
<span class="sig-name descname"><span class="pre">write_restart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasData.TruchasData.write_restart" title="Link to this definition"></a></dt>
<dd><p>Write a restart file from given Truchas data object and series ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outfile</strong> (<em>str</em>) – The name of the restart file to be generated.</p></li>
<li><p><strong>series_id</strong> (<em>int</em>) – The ID of a series in the Truchas output file. Valid
values are in the range <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">TruchasData.num_series()]</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-truchas.TruchasMappedData">
<span id="truchasmappeddata"></span><h3><a class="toc-backref" href="#id8" role="doc-backlink">TruchasMappedData</a><a class="headerlink" href="#module-truchas.TruchasMappedData" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="truchas.TruchasMappedData.TruchasMappedData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TruchasMappedData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exodus_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_portage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasMappedData.TruchasMappedData" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#truchas.TruchasData.TruchasData" title="truchas.TruchasData.TruchasData"><code class="xref py py-class docutils literal notranslate"><span class="pre">TruchasData</span></code></a></p>
<p>Interface for mapping Truchas Data to new exodus mesh. This class
inherits all of the methods from the <code class="xref py py-class docutils literal notranslate"><span class="pre">TruchasData</span></code> class, and
invisibly maps fields to the new mesh prior to returning them.
Initialization takes extra parameters for mapping.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – Filename of the Truchas h5 output file.</p></li>
<li><p><strong>exodus_filename</strong> (<em>str</em>) – Filename of the exodus mesh file to which the data
shall be mapped</p></li>
<li><p><strong>scale_factor</strong> (<em>number</em>) – Scaling factor for the target exodus mesh.</p></li>
<li><p><strong>use_portage</strong> (<em>bool</em>) – Flag to use the Portage backend rather than the Truchas
built-in mapper. Defaults to False, using the Truchas built-in mapper.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasMappedData.TruchasMappedData.finalize">
<span class="sig-name descname"><span class="pre">finalize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasMappedData.TruchasMappedData.finalize" title="Link to this definition"></a></dt>
<dd><p>Free the memory used by the grid mapper. If mapping between multiple
different mesh combinations, it’s best to call this directly rather than
wait for Python garbage collection to clean it up.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-truchas.TruchasStudy">
<span id="truchasstudy"></span><h3><a class="toc-backref" href="#id9" role="doc-backlink">TruchasStudy</a><a class="headerlink" href="#module-truchas.TruchasStudy" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="truchas.TruchasStudy.TruchasStudy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TruchasStudy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tenv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nprocs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">njobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restart_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasStudy.TruchasStudy" title="Link to this definition"></a></dt>
<dd><p>A class for performing Truchas parameter studies which vary in one
parameter (1D). This class expects a Truchas environment which will perform
the tests (or generate input decks) and a Truchas Database which will cache
the results.</p>
<p>One will generally want to execute either <a class="reference internal" href="#truchas.TruchasStudy.TruchasStudy.do_1d_parameter_study" title="truchas.TruchasStudy.TruchasStudy.do_1d_parameter_study"><code class="xref py py-func docutils literal notranslate"><span class="pre">do_1d_parameter_study()</span></code></a>, or
<a class="reference internal" href="#truchas.TruchasStudy.TruchasStudy.generate_1d_parameter_study_inputs" title="truchas.TruchasStudy.TruchasStudy.generate_1d_parameter_study_inputs"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_1d_parameter_study_inputs()</span></code></a> and
<a class="reference internal" href="#truchas.TruchasStudy.TruchasStudy.register_1d_parameter_study_outputs" title="truchas.TruchasStudy.TruchasStudy.register_1d_parameter_study_outputs"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_1d_parameter_study_outputs()</span></code></a> and
<a class="reference internal" href="#truchas.TruchasStudy.TruchasStudy.do_1d_parameter_study" title="truchas.TruchasStudy.TruchasStudy.do_1d_parameter_study"><code class="xref py py-func docutils literal notranslate"><span class="pre">do_1d_parameter_study()</span></code></a> in that order.</p>
<p>In the former case, the parameter study will be performed by sequentially
running Truchas on the supplied metric. In the latter case, a collection of
input files will be generated, which might be executed on a cluster via a
SLURM array job. The results of these studies are then registered to the
supplied database via the <a class="reference internal" href="#truchas.TruchasStudy.TruchasStudy.register_1d_parameter_study_outputs" title="truchas.TruchasStudy.TruchasStudy.register_1d_parameter_study_outputs"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_1d_parameter_study_outputs()</span></code></a>
method. At this point, running <a class="reference internal" href="#truchas.TruchasStudy.TruchasStudy.do_1d_parameter_study" title="truchas.TruchasStudy.TruchasStudy.do_1d_parameter_study"><code class="xref py py-func docutils literal notranslate"><span class="pre">do_1d_parameter_study()</span></code></a> will read
outputs from the database of Truchas outputs instead of executing
simulations.</p>
<p>To initialize:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tenv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">TruchasEnvironment</span></code>) – A <code class="xref py py-class docutils literal notranslate"><span class="pre">TruchasEnvironment</span></code> for running the parameter study.</p></li>
<li><p><strong>tdb</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">TruchasDatabase</span></code>) – A <code class="xref py py-class docutils literal notranslate"><span class="pre">TruchasDatabase</span></code> where results will be cached.</p></li>
<li><p><strong>nproc</strong> (<em>int</em>) – Number of MPI ranks to use. When used with
<a class="reference internal" href="#truchas.TruchasStudy.TruchasStudy.generate_1d_parameter_study_inputs" title="truchas.TruchasStudy.TruchasStudy.generate_1d_parameter_study_inputs"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_1d_parameter_study_inputs()</span></code></a>, this parameter is ignored.</p></li>
<li><p><strong>njobs</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default 1</em><em>)</em>) – Number of Truchas simulations to run in simultaneously.</p></li>
<li><p><strong>restart_file</strong> (<em>str</em><em>, </em><em>optional</em><em> (</em><em>default None</em><em>)</em>) – Filename of Truchas restart file. This restart will be
used for all runs.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasStudy.TruchasStudy.do_1d_parameter_study">
<span class="sig-name descname"><span class="pre">do_1d_parameter_study</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">template_input_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasStudy.TruchasStudy.do_1d_parameter_study" title="Link to this definition"></a></dt>
<dd><p>Do a 1D parameter study of the given variable, across the given
points. Output metrics are recorded to a text file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_parameters</strong> (<em>dict with str keys</em>) – A dictionary of input parameters to supply to
<code class="xref py py-func docutils literal notranslate"><span class="pre">TruchasEnvironment.generate_input_deck()</span></code>. Keys are the python
format variables present in the template input deck. Values are
either values to replace those format strings, or functions. If a
function, it is evaluated with a single input: the dict of
parameters in the current iteration. This allows values to be
generated based on other values at this iteration. E.g., the “h2”
key could hold a lambda which always returns double the value of the
“h1” key.</p></li>
<li><p><strong>variable</strong> (<em>str</em>) – The name of a variable in the initial_parameters
dictionary which is to be varied for the parameter study.</p></li>
<li><p><strong>points</strong> (<em>list</em><em> of </em><em>values</em>) – The values of the variable to iterate over for the
parameter study.</p></li>
<li><p><strong>output_metrics</strong> (<em>dict with str keys and function values.</em>) – A dictionary of output metrics to be printed to
the output file. Functions are expected to accept two arguments: the
input parameter dictionary and a <code class="xref py py-class docutils literal notranslate"><span class="pre">TruchasData</span></code> output set.
These functions are to be written by the user to generate custom
outputs. The result of each function must be a string.</p></li>
<li><p><strong>output_filename</strong> (<em>str</em>) – A filename where the table of inputs and outputs
will be written.</p></li>
<li><p><strong>extra_outputs</strong> (<em>function</em><em>, </em><em>optional</em>) – A function of four arguments, the parameter
dictionary, the Truchas output, the study filename (intended for
generating new filenames), and the parameter study iteration index.
This is for custom operations to be performed at each run. For
instance, generating unique new files each containing the maximum
temperature evolution for a different run.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Toolpath filename should be specified in the template.inp file
with the parameter <code class="docutils literal notranslate"><span class="pre">{toolpath_file}</span></code>. This parameter is skipped
when generating the instance unique identifier, so both the
Truchas input file and toolpath file are renamed to a unique
identifier independent of the toolpath filename.</p></li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>TODO Some current hardwired shortcomings…</p>
<ul class="simple">
<li><p>Toolpath templates are hardcoded to be “template.json”.</p></li>
<li><p>Only a single json toolpath file is permitted, or none. The
parameter key “toolpath_file” is disregarded when generating an
input deck’s unique identifier for the TruchasDatabase. This is
because the toolpath file ought to be named with the same hash as
the input file.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasStudy.TruchasStudy.generate_1d_parameter_study_inputs">
<span class="sig-name descname"><span class="pre">generate_1d_parameter_study_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">template_input_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasStudy.TruchasStudy.generate_1d_parameter_study_inputs" title="Link to this definition"></a></dt>
<dd><p>Generate input decks across a given span of data points. This is
intended for generating inputs to then be simulated on a cluster via
SLURM, not in a Python environment. These output files will be stored
in the directory <code class="docutils literal notranslate"><span class="pre">parameter_study_inputs</span></code>. With this approach, it is
expected to:</p>
<ol class="arabic simple">
<li><p>Use <a class="reference internal" href="#truchas.TruchasStudy.TruchasStudy.generate_1d_parameter_study_inputs" title="truchas.TruchasStudy.TruchasStudy.generate_1d_parameter_study_inputs"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_1d_parameter_study_inputs()</span></code></a> to generate Truchas
input files in the <code class="docutils literal notranslate"><span class="pre">parameter_study_inputs</span></code> directory.</p></li>
<li><p>Run Truchas independent of Python, e.g. via a SLURM script.</p></li>
<li><p>Use <code class="xref py py-func docutils literal notranslate"><span class="pre">register_1d_parameter_study_inputs()</span></code> to identify the
Truchas outputs and move them into a <code class="xref py py-class docutils literal notranslate"><span class="pre">TruchasDatabase</span></code>.</p></li>
<li><p>Use <a class="reference internal" href="#truchas.TruchasStudy.TruchasStudy.do_1d_parameter_study" title="truchas.TruchasStudy.TruchasStudy.do_1d_parameter_study"><code class="xref py py-func docutils literal notranslate"><span class="pre">do_1d_parameter_study()</span></code></a> to “run” the parameter study. This
time, all of the outputs will be recognized as already-generated in
the database, so only the postprocessing will be performed.</p></li>
</ol>
<p>See <a class="reference internal" href="#truchas.TruchasStudy.TruchasStudy.do_1d_parameter_study" title="truchas.TruchasStudy.TruchasStudy.do_1d_parameter_study"><code class="xref py py-func docutils literal notranslate"><span class="pre">do_1d_parameter_study()</span></code></a> for argument documentation.</p>
<p>An example SLURM script is shown below for running each of these
generated input files in a single array job.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#SBATCH -a 1-16  # Run 16 duplicates of this job in parallel</span>

<span class="nb">cd</span><span class="w"> </span>&lt;path-to-parameter-study-inputs&gt;

<span class="c1"># exit if this run doesn&#39;t correspond to a file</span>
<span class="nv">nfiles</span><span class="o">=</span><span class="k">$(</span>ls<span class="w"> </span>-1<span class="w"> </span>*.inp<span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l<span class="k">)</span>
<span class="o">((</span><span class="w"> </span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$nfiles</span><span class="w"> </span><span class="o">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">exit</span>

<span class="c1"># select a unique input file from an alphabatized list and my job array ID</span>
<span class="nv">inputfile</span><span class="o">=</span><span class="k">$(</span>ls<span class="w"> </span>-1<span class="w"> </span>*.inp<span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SLURM_ARRAY_TASK_ID</span><span class="si">}</span><span class="s2">p&quot;</span><span class="k">)</span>
ml<span class="w"> </span>truchas
srun<span class="w"> </span>truchas<span class="w"> </span><span class="nv">$inputfile</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasStudy.TruchasStudy.register_1d_parameter_study_outputs">
<span class="sig-name descname"><span class="pre">register_1d_parameter_study_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasStudy.TruchasStudy.register_1d_parameter_study_outputs" title="Link to this definition"></a></dt>
<dd><p>Register Truchas simulation outputs and input decks to a database. If
<a class="reference internal" href="#truchas.TruchasStudy.TruchasStudy.generate_1d_parameter_study_inputs" title="truchas.TruchasStudy.TruchasStudy.generate_1d_parameter_study_inputs"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_1d_parameter_study_inputs()</span></code></a> is used to generate input
files in the directory <code class="docutils literal notranslate"><span class="pre">parameter_study_inputs</span></code>, then Truchas is used
externally to generate outputs for each of these input files, this
function is used to register those outputs to a
<code class="xref py py-class docutils literal notranslate"><span class="pre">TruchasDatabase</span></code>.</p>
<p>See <a class="reference internal" href="#truchas.TruchasStudy.TruchasStudy.do_1d_parameter_study" title="truchas.TruchasStudy.TruchasStudy.do_1d_parameter_study"><code class="xref py py-func docutils literal notranslate"><span class="pre">do_1d_parameter_study()</span></code></a> for argument documentation. See
<a class="reference internal" href="#truchas.TruchasStudy.TruchasStudy.generate_1d_parameter_study_inputs" title="truchas.TruchasStudy.TruchasStudy.generate_1d_parameter_study_inputs"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_1d_parameter_study_inputs()</span></code></a> for the workflow description.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-truchas.TruchasDatabase">
<span id="truchasdatabase"></span><h3><a class="toc-backref" href="#id10" role="doc-backlink">TruchasDatabase</a><a class="headerlink" href="#module-truchas.TruchasDatabase" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="truchas.TruchasDatabase.TruchasDatabase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TruchasDatabase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasDatabase.TruchasDatabase" title="Link to this definition"></a></dt>
<dd><p>Records Truchas outputs into a database for easy lookup. This class is
used by <code class="xref py py-class docutils literal notranslate"><span class="pre">TruchasStudy</span></code>, and for most user code will not need to be
used directly except for initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> (<em>str</em>) – A directory where the database will be stored. Should be
either an empty directory, nonexistent directory, or the path of an
already-existing database.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasDatabase.TruchasDatabase.append_new_parameters">
<span class="sig-name descname"><span class="pre">append_new_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasDatabase.TruchasDatabase.append_new_parameters" title="Link to this definition"></a></dt>
<dd><p>Append a new set of parameters to the database. This requires
rehashing all identifiers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parameters</strong> (<em>a dict with str keys and non-function values</em>) – A dictionary of template replacements, including any
new keys that were not present in previous database entries. For
accuracy, any new keys must contain the value that was used in old
runs (where presumably they were hardcoded in the input file).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasDatabase.TruchasDatabase.backup_database">
<span class="sig-name descname"><span class="pre">backup_database</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasDatabase.TruchasDatabase.backup_database" title="Link to this definition"></a></dt>
<dd><p>Create a backup file <code class="docutils literal notranslate"><span class="pre">database-backup.json</span></code> in the database
directory. This backs up the database structure, not the Truchas inputs
nor output data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasDatabase.TruchasDatabase.delete">
<span class="sig-name descname"><span class="pre">delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasDatabase.TruchasDatabase.delete" title="Link to this definition"></a></dt>
<dd><p>Delete the data associated with the given parameter set from the
database. Note this will delete all associated data from disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parameters</strong> (<em>a dict with str keys and non-function values</em>) – A dictionary of template replacements. Unlike
<code class="xref py py-func docutils literal notranslate"><span class="pre">TruchasStudy.do_1d_parameter_study()</span></code>, this cannot contain
functions (rather, it expects the functions have already been
evaluated). This is so that a unique identifier can be produced.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasDatabase.TruchasDatabase.donate">
<span class="sig-name descname"><span class="pre">donate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasDatabase.TruchasDatabase.donate" title="Link to this definition"></a></dt>
<dd><p>Add the input file and Truchas output directory associated with a set
of parameters to the database. Note this will overwrite any existing
item associated with the parameter set in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<em>a dict with str keys and non-function values</em>) – A dictionary of template replacements. Unlike
<code class="xref py py-func docutils literal notranslate"><span class="pre">TruchasStudy.do_1d_parameter_study()</span></code>, this cannot contain
functions (rather, it expects the functions have already been
evaluated). This is so that a unique identifier can be produced.</p></li>
<li><p><strong>infile</strong> (<em>str</em>) – A Truchas input file</p></li>
<li><p><strong>dump_dir</strong> (<em>str</em>) – A Truchas output dir associated with infile</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasDatabase.TruchasDatabase.exists">
<span class="sig-name descname"><span class="pre">exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasDatabase.TruchasDatabase.exists" title="Link to this definition"></a></dt>
<dd><p>Checks if the given parameter combination is present in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parameters</strong> (<em>a dict with str keys and non-function values</em>) – A dictionary of template replacements. Unlike
<code class="xref py py-func docutils literal notranslate"><span class="pre">TruchasStudy.do_1d_parameter_study()</span></code>, this cannot contain
functions (rather, it expects the functions have already been
evaluated). This is so that a unique identifier can be produced.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the Truchas results associated with <code class="docutils literal notranslate"><span class="pre">parameters</span></code> is
already present in the database, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasDatabase.TruchasDatabase.identifier">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">identifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasDatabase.TruchasDatabase.identifier" title="Link to this definition"></a></dt>
<dd><p>Generates a unique identifier for the given parameter dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parameters</strong> (<em>a dict with str keys and non-function values</em>) – A dictionary of template replacements. Unlike
<code class="xref py py-func docutils literal notranslate"><span class="pre">TruchasStudy.do_1d_parameter_study()</span></code>, this cannot contain
functions (rather, it expects the functions have already been
evaluated). This is so that a unique identifier can be produced.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Unique identifier hash</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="truchas.TruchasDatabase.TruchasDatabase.truchas_output">
<span class="sig-name descname"><span class="pre">truchas_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasDatabase.TruchasDatabase.truchas_output" title="Link to this definition"></a></dt>
<dd><p>Return the Truchas output corresponding to the given parameters. If
such an output does not exist, return None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parameters</strong> (<em>a dict with str keys and non-function values</em>) – A dictionary of template replacements. Unlike
<code class="xref py py-func docutils literal notranslate"><span class="pre">TruchasStudy.do_1d_parameter_study()</span></code>, this cannot contain
functions (rather, it expects the functions have already been
evaluated). This is so that a unique identifier can be produced.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Truchas output associated with <code class="docutils literal notranslate"><span class="pre">parameters</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TruchasData</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-truchas.TruchasTest">
<span id="truchastest"></span><h3><a class="toc-backref" href="#id11" role="doc-backlink">TruchasTest</a><a class="headerlink" href="#module-truchas.TruchasTest" title="Link to this heading"></a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="truchas.TruchasTest.compare_l2">
<span class="sig-name descname"><span class="pre">compare_l2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasTest.compare_l2" title="Link to this definition"></a></dt>
<dd><p>Calculates the L2 norm between two fields,
and compares against an input tolerance. Returns 0 if error is below
tolerance and 1 otherwise. Prints result of comparison to terminal.
Fields may be a scalar value.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="truchas.TruchasTest.compare_max">
<span class="sig-name descname"><span class="pre">compare_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasTest.compare_max" title="Link to this definition"></a></dt>
<dd><p>Calculates the maximum absolute difference between two fields,
and compares against an input tolerance. Returns 0 if error is below
tolerance and 1 otherwise. Prints result of comparison to terminal.
Fields may be a scalar value.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="truchas.TruchasTest.compare_max_rel">
<span class="sig-name descname"><span class="pre">compare_max_rel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#truchas.TruchasTest.compare_max_rel" title="Link to this definition"></a></dt>
<dd><p>Calculates the maximum relative absolute difference between two fields,
and compares against an input tolerance. Returns 0 if error is below
tolerance and 1 otherwise. Prints result of comparison to terminal.
Fields may be a scalar value.</p>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../rade/PATCHES_Namelist_Expert_Options.html" class="btn btn-neutral float-left" title="PATCHES Namelist (Expert Options)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2023, The Truchas Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>